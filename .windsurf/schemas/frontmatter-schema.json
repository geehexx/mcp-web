{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Workflow and Rule Frontmatter Schema",
  "description": "YAML frontmatter schema for .windsurf/ workflow and rule files",
  "type": "object",
  "required": ["description"],
  "properties": {
    "description": {
      "type": "string",
      "description": "One-sentence summary of the workflow or rule",
      "minLength": 10,
      "maxLength": 200
    },
    "auto_execution_mode": {
      "type": "integer",
      "description": "Execution mode (always 3 for standard workflows)",
      "enum": [2, 3],
      "default": 3
    },
    "created": {
      "type": "string",
      "description": "Creation date in YYYY-MM-DD format",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
    },
    "updated": {
      "type": "string",
      "description": "Last update date in YYYY-MM-DD format",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
    },
    "category": {
      "type": "string",
      "description": "File category for classification",
      "enum": [
        "Orchestrator",
        "Planning",
        "Implementation",
        "Validation",
        "Automation",
        "Analysis",
        "Documentation",
        "Operations",
        "Sub-workflow",
        "Reference Guide",
        "Specialized Operation",
        "core",
        "testing",
        "language",
        "documentation",
        "security",
        "operations"
      ]
    },
    "complexity": {
      "type": "integer",
      "description": "Complexity score from 0-100",
      "minimum": 0,
      "maximum": 100
    },
    "tokens": {
      "type": "integer",
      "description": "Estimated token count",
      "minimum": 0
    },
    "dependencies": {
      "type": "array",
      "description": "List of required workflow names",
      "items": {
        "type": "string"
      },
      "uniqueItems": true
    },
    "status": {
      "type": "string",
      "description": "Current status of the workflow or rule",
      "enum": ["active", "deprecated", "experimental"],
      "default": "active"
    },
    "trigger": {
      "type": "string",
      "description": "When this rule should be applied",
      "enum": ["always_on", "file_operations", "testing", "security", "documentation", "glob", "model_decision", "session_management", "python_code"]
    },
    "applyTo": {
      "type": "array",
      "description": "Contexts where this rule applies",
      "items": {
        "type": "string"
      },
      "uniqueItems": true
    },
    "priority": {
      "type": "string",
      "description": "Priority level for rules",
      "enum": ["high", "medium", "low"]
    },
    "parent": {
      "type": "string",
      "description": "Parent workflow file for sub-workflows",
      "pattern": "^[a-z-]+\\.md$"
    }
  },
  "oneOf": [
    {
      "description": "Workflow file schema",
      "properties": {
        "category": {
          "enum": [
            "Orchestrator",
            "Planning",
            "Implementation",
            "Validation",
            "Automation",
            "Analysis",
            "Documentation",
            "Operations",
            "Sub-workflow",
            "Reference Guide",
            "Specialized Operation"
          ]
        }
      }
    },
    {
      "description": "Rule file schema",
      "properties": {
        "category": {
          "enum": [
            "core",
            "testing",
            "language",
            "documentation",
            "security",
            "operations"
          ]
        },
        "trigger": {
          "type": "string"
        }
      },
      "required": ["trigger"]
    }
  ]
}
